<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Java学习笔记(第二十七天) | 虾米日记</title>
  <link rel = 'canonical' href = 'https://wjinlei.github.io/posts/exp-java-day27/'>
  <meta name="description" content="对酒当歌，人生几何，譬如朝露，去日苦多">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Java学习笔记(第二十七天)" />
<meta property="og:description" content="WEB后端开发中的三层结构  Controller 只做和HTTP请求响应相关的事情 Service 做的事情最多,处理业务逻辑 DAO 只做数据库操作相关的事情  为Springboot添加MyBatis模块 Springboot为我们准备了很多为初学者准备的模块,称为starter
 添加MyBatis模块  &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.2.0&lt;/version&gt; &lt;/dependency&gt;  配置Springboot数据源  spring.datasource.url=jdbc:h2:file:./target/test spring.datasource.username=root spring.datasource.password=root spring.datasource.driver-class-name=org.h2.Driver mybatis.config-location=classpath:db/mybatis/mybatis-config.xml  配置MyBatis  &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt; &lt;!DOCTYPE configuration PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt; &lt;configuration&gt; &lt;!-- 因为mybatis的环境配置已经在Spring中配置了,因此这里只需要Mapper配置即可 --&gt; &lt;mappers&gt; &lt;mapper resource=&#34;db/mybatis/mybatis-mapper.xml&#34;/&gt; &lt;/mappers&gt; &lt;/configuration&gt; 其他的操作就和正常使用MyBatis一样了
关于Bean 之前我们了解到,在MyBatis中配置SQL可以用接口的方式,只要声明一个接口,获取一个Mapper对象,就可以直接执行SQL了
/** * 删除一个用户。 * * @param id 待删除的用户ID */ public void deleteUserById(Integer id) { try (SqlSession sqlSession = sqlSessionFactory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wjinlei.github.io/posts/exp-java-day27/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-21T05:54:12+08:00" />
<meta property="article:modified_time" content="2021-11-21T05:54:12+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Java学习笔记(第二十七天)"/>
<meta name="twitter:description" content="WEB后端开发中的三层结构  Controller 只做和HTTP请求响应相关的事情 Service 做的事情最多,处理业务逻辑 DAO 只做数据库操作相关的事情  为Springboot添加MyBatis模块 Springboot为我们准备了很多为初学者准备的模块,称为starter
 添加MyBatis模块  &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.2.0&lt;/version&gt; &lt;/dependency&gt;  配置Springboot数据源  spring.datasource.url=jdbc:h2:file:./target/test spring.datasource.username=root spring.datasource.password=root spring.datasource.driver-class-name=org.h2.Driver mybatis.config-location=classpath:db/mybatis/mybatis-config.xml  配置MyBatis  &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt; &lt;!DOCTYPE configuration PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt; &lt;configuration&gt; &lt;!-- 因为mybatis的环境配置已经在Spring中配置了,因此这里只需要Mapper配置即可 --&gt; &lt;mappers&gt; &lt;mapper resource=&#34;db/mybatis/mybatis-mapper.xml&#34;/&gt; &lt;/mappers&gt; &lt;/configuration&gt; 其他的操作就和正常使用MyBatis一样了
关于Bean 之前我们了解到,在MyBatis中配置SQL可以用接口的方式,只要声明一个接口,获取一个Mapper对象,就可以直接执行SQL了
/** * 删除一个用户。 * * @param id 待删除的用户ID */ public void deleteUserById(Integer id) { try (SqlSession sqlSession = sqlSessionFactory."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://wjinlei.github.io/css/styles.4c2b9aa1d874d6766f554b2d404e8fd62ab4761f51ee9b3f358d12e81e7fa43a1b4378db995bc1926bbe5ed98c060be5e7bd4f2470504cf94f22b4b3a74e62b6.css" integrity="sha512-TCuaodh01nZvVUstQE6P1iq0dh9R7ps/NY0S6B5/pDobQ3jbmVvBkmu&#43;XtmMBgvl571PJHBQTPlPIrSzp05itg=="> 

  
   <link rel="stylesheet" href="https://wjinlei.github.io/css/custom.css"> 
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://wjinlei.github.io/images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://wjinlei.github.io/posts/exp-java-day26/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://wjinlei.github.io/posts/exp-java-day28/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&text=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&title=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&is_video=false&description=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29&body=Check out this article: https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&title=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&title=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&name=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29&description=WEB%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91%e4%b8%ad%e7%9a%84%e4%b8%89%e5%b1%82%e7%bb%93%e6%9e%84%20%20Controller%20%e5%8f%aa%e5%81%9a%e5%92%8cHTTP%e8%af%b7%e6%b1%82%e5%93%8d%e5%ba%94%e7%9b%b8%e5%85%b3%e7%9a%84%e4%ba%8b%e6%83%85%20Service%20%e5%81%9a%e7%9a%84%e4%ba%8b%e6%83%85%e6%9c%80%e5%a4%9a%2c%e5%a4%84%e7%90%86%e4%b8%9a%e5%8a%a1%e9%80%bb%e8%be%91%20DAO%20%e5%8f%aa%e5%81%9a%e6%95%b0%e6%8d%ae%e5%ba%93%e6%93%8d%e4%bd%9c%e7%9b%b8%e5%85%b3%e7%9a%84%e4%ba%8b%e6%83%85%20%20%e4%b8%baSpringboot%e6%b7%bb%e5%8a%a0MyBatis%e6%a8%a1%e5%9d%97%20Springboot%e4%b8%ba%e6%88%91%e4%bb%ac%e5%87%86%e5%a4%87%e4%ba%86%e5%be%88%e5%a4%9a%e4%b8%ba%e5%88%9d%e5%ad%a6%e8%80%85%e5%87%86%e5%a4%87%e7%9a%84%e6%a8%a1%e5%9d%97%2c%e7%a7%b0%e4%b8%bastarter%0a%20%e6%b7%bb%e5%8a%a0MyBatis%e6%a8%a1%e5%9d%97%20%20%26lt%3bdependency%26gt%3b%20%26lt%3bgroupId%26gt%3borg.mybatis.spring.boot%26lt%3b%2fgroupId%26gt%3b%20%26lt%3bartifactId%26gt%3bmybatis-spring-boot-starter%26lt%3b%2fartifactId%26gt%3b%20%26lt%3bversion%26gt%3b2.2.0%26lt%3b%2fversion%26gt%3b%20%26lt%3b%2fdependency%26gt%3b%20%20%e9%85%8d%e7%bd%aeSpringboot%e6%95%b0%e6%8d%ae%e6%ba%90%20%20spring.datasource.url%3djdbc%3ah2%3afile%3a.%2ftarget%2ftest%20spring.datasource.username%3droot%20spring.datasource.password%3droot%20spring.datasource.driver-class-name%3dorg.h2.Driver%20mybatis.config-location%3dclasspath%3adb%2fmybatis%2fmybatis-config.xml%20%20%e9%85%8d%e7%bd%aeMyBatis%20%20%26lt%3b%3fxml%20version%3d%26%2334%3b1.0%26%2334%3b%20encoding%3d%26%2334%3bUTF-8%26%2334%3b%20%3f%26gt%3b%20%26lt%3b%21DOCTYPE%20configuration%20PUBLIC%20%26%2334%3b-%2f%2fmybatis.org%2f%2fDTD%20Config%203.0%2f%2fEN%26%2334%3b%20%26%2334%3bhttp%3a%2f%2fmybatis.org%2fdtd%2fmybatis-3-config.dtd%26%2334%3b%26gt%3b%20%26lt%3bconfiguration%26gt%3b%20%26lt%3b%21--%20%e5%9b%a0%e4%b8%bamybatis%e7%9a%84%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae%e5%b7%b2%e7%bb%8f%e5%9c%a8Spring%e4%b8%ad%e9%85%8d%e7%bd%ae%e4%ba%86%2c%e5%9b%a0%e6%ad%a4%e8%bf%99%e9%87%8c%e5%8f%aa%e9%9c%80%e8%a6%81Mapper%e9%85%8d%e7%bd%ae%e5%8d%b3%e5%8f%af%20--%26gt%3b%20%26lt%3bmappers%26gt%3b%20%26lt%3bmapper%20resource%3d%26%2334%3bdb%2fmybatis%2fmybatis-mapper.xml%26%2334%3b%2f%26gt%3b%20%26lt%3b%2fmappers%26gt%3b%20%26lt%3b%2fconfiguration%26gt%3b%20%e5%85%b6%e4%bb%96%e7%9a%84%e6%93%8d%e4%bd%9c%e5%b0%b1%e5%92%8c%e6%ad%a3%e5%b8%b8%e4%bd%bf%e7%94%a8MyBatis%e4%b8%80%e6%a0%b7%e4%ba%86%0a%e5%85%b3%e4%ba%8eBean%20%e4%b9%8b%e5%89%8d%e6%88%91%e4%bb%ac%e4%ba%86%e8%a7%a3%e5%88%b0%2c%e5%9c%a8MyBatis%e4%b8%ad%e9%85%8d%e7%bd%aeSQL%e5%8f%af%e4%bb%a5%e7%94%a8%e6%8e%a5%e5%8f%a3%e7%9a%84%e6%96%b9%e5%bc%8f%2c%e5%8f%aa%e8%a6%81%e5%a3%b0%e6%98%8e%e4%b8%80%e4%b8%aa%e6%8e%a5%e5%8f%a3%2c%e8%8e%b7%e5%8f%96%e4%b8%80%e4%b8%aaMapper%e5%af%b9%e8%b1%a1%2c%e5%b0%b1%e5%8f%af%e4%bb%a5%e7%9b%b4%e6%8e%a5%e6%89%a7%e8%a1%8cSQL%e4%ba%86%0a%2f%2a%2a%20%2a%20%e5%88%a0%e9%99%a4%e4%b8%80%e4%b8%aa%e7%94%a8%e6%88%b7%e3%80%82%20%2a%20%2a%20%40param%20id%20%e5%be%85%e5%88%a0%e9%99%a4%e7%9a%84%e7%94%a8%e6%88%b7ID%20%2a%2f%20public%20void%20deleteUserById%28Integer%20id%29%20%7b%20try%20%28SqlSession%20sqlSession%20%3d%20sqlSessionFactory." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&t=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Java学习笔记(第二十七天)
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2021-11-21 05:54:12 &#43;0800 CST" itemprop="datePublished">2021-11-21</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          14 minute read
        </div>
        
        
        
      </div>
    </header>

  
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#web后端开发中的三层结构">WEB后端开发中的三层结构</a></li>
    <li><a href="#为springboot添加mybatis模块">为Springboot添加MyBatis模块</a></li>
    <li><a href="#关于bean">关于Bean</a>
      <ul>
        <li><a href="#mapper注解">@Mapper注解</a></li>
        <li><a href="#service-注解">@Service 注解</a></li>
        <li><a href="#优先使用构造器注入而不要使用autowired字段注入">优先使用构造器注入,而不要使用@Autowired字段注入</a></li>
      </ul>
    </li>
    <li><a href="#为springboot添加-freemarker-模板引擎">为Springboot添加 Freemarker 模板引擎</a></li>
    <li><a href="#aop面向切面编程-aspect-oriented-programming">AOP(面向切面编程 Aspect-oriented programming)</a></li>
    <li><a href="#装饰器模式">装饰器模式</a></li>
    <li><a href="#aop的两种实现jdk动态代理和字节码生成">AOP的两种实现,JDK动态代理和字节码生成</a>
      <ul>
        <li><a href="#jdk动态代理">JDK动态代理</a></li>
        <li><a href="#cglibbytebuddy">CGLIB/ByteBuddy</a></li>
      </ul>
    </li>
    <li><a href="#在springboot中使用aop">在Springboot中使用AOP</a>
      <ul>
        <li><a href="#关于切面的拦截方式">关于切面的拦截方式</a></li>
      </ul>
    </li>
    <li><a href="#redis">Redis</a>
      <ul>
        <li><a href="#在springboot中使用redis">在Springboot中使用Redis</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
    <div class="content" itemprop="articleBody">
      <h2 id="web后端开发中的三层结构">WEB后端开发中的三层结构</h2>
<ul>
<li>Controller <code>只做和HTTP请求响应相关的事情</code></li>
<li>Service <code>做的事情最多,处理业务逻辑</code></li>
<li>DAO <code>只做数据库操作相关的事情</code></li>
</ul>
<h2 id="为springboot添加mybatis模块">为Springboot添加MyBatis模块</h2>
<p>Springboot为我们准备了很多为初学者准备的模块,称为<code>starter</code></p>
<ul>
<li>添加MyBatis模块</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;dependency&gt;</span>
    <span style="color:#000080">&lt;groupId&gt;</span>org.mybatis.spring.boot<span style="color:#000080">&lt;/groupId&gt;</span>
    <span style="color:#000080">&lt;artifactId&gt;</span>mybatis-spring-boot-starter<span style="color:#000080">&lt;/artifactId&gt;</span>
    <span style="color:#000080">&lt;version&gt;</span>2.2.0<span style="color:#000080">&lt;/version&gt;</span>
<span style="color:#000080">&lt;/dependency&gt;</span>
</code></pre></div><ul>
<li>配置Springboot数据源</li>
</ul>
<pre tabindex="0"><code class="language-properties" data-lang="properties">spring.datasource.url=jdbc:h2:file:./target/test
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=org.h2.Driver
mybatis.config-location=classpath:db/mybatis/mybatis-config.xml
</code></pre><ul>
<li>配置MyBatis</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE configuration
</span><span style="color:#999;font-weight:bold;font-style:italic">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span style="color:#999;font-weight:bold;font-style:italic">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span style="color:#000080">&lt;configuration&gt;</span>
    <span style="color:#998;font-style:italic">&lt;!-- 因为mybatis的环境配置已经在Spring中配置了,因此这里只需要Mapper配置即可 --&gt;</span>
    <span style="color:#000080">&lt;mappers&gt;</span>
        <span style="color:#000080">&lt;mapper</span> <span style="color:#008080">resource=</span><span style="color:#d14">&#34;db/mybatis/mybatis-mapper.xml&#34;</span><span style="color:#000080">/&gt;</span>
    <span style="color:#000080">&lt;/mappers&gt;</span>
<span style="color:#000080">&lt;/configuration&gt;</span>
</code></pre></div><p>其他的操作就和正常使用MyBatis一样了</p>
<h2 id="关于bean">关于Bean</h2>
<p>之前我们了解到,在MyBatis中配置SQL可以用接口的方式,只要声明一个接口,获取一个Mapper对象,就可以直接执行SQL了</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#998;font-style:italic">/**
</span><span style="color:#998;font-style:italic"> * 删除一个用户。
</span><span style="color:#998;font-style:italic"> *
</span><span style="color:#998;font-style:italic"> * @param id 待删除的用户ID
</span><span style="color:#998;font-style:italic"> */</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">deleteUserById</span><span style="color:#000;font-weight:bold">(</span>Integer id<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">(</span>SqlSession sqlSession <span style="color:#000;font-weight:bold">=</span> sqlSessionFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">openSession</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        DeleteUserByIdMapper mapper <span style="color:#000;font-weight:bold">=</span> sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>DeleteUserByIdMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 可以看到,必须获取Mapper对象
</span><span style="color:#998;font-style:italic"></span>        mapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">deleteUserById</span><span style="color:#000;font-weight:bold">(</span>id<span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">DeleteUserByIdMapper</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#3c5d5d;font-weight:bold">@Delete</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;DELETE FROM user WHERE ID = #{id}&#34;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">deleteUserById</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3c5d5d;font-weight:bold">@Param</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;id&#34;</span><span style="color:#000;font-weight:bold">)</span> Integer id<span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="mapper注解">@Mapper注解</h3>
<p>在Springboot中,我们通过一个<code>@Mapper</code>注解,Mybatis就会帮我们自动进行依赖注入</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#3c5d5d;font-weight:bold">@Mapper</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">UserMapper</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#3c5d5d;font-weight:bold">@Select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;SELECT * FROM user WHERE id = #{id}&#34;</span><span style="color:#000;font-weight:bold">)</span>
    User <span style="color:#900;font-weight:bold">getUserById</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3c5d5d;font-weight:bold">@Param</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;id&#34;</span><span style="color:#000;font-weight:bold">)</span> Integer id<span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>但我们自己的类,如何告诉Spring这是一个Bean,并且帮我进行依赖注入呢?<br>
因为如果你不告诉Spring,那么它就是一个普通的类,普通的类就意味着它必须实例化<br>
而且需要你自己传入传出</p>
<h3 id="service-注解">@Service 注解</h3>
<p>我们通过给普通的类加上<code>@Service</code>注解,Springboot就可以识别它是一个Bean了,<br>
这时候你通过<code>@Autowired</code>注解就可以自动注入了</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#3c5d5d;font-weight:bold">@Service</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">RankDao</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#3c5d5d;font-weight:bold">@Autowired</span>
    <span style="color:#000;font-weight:bold">private</span> SqlSession sqlSession<span style="color:#000;font-weight:bold">;</span>

    <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>Rank<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">selectRankList</span><span style="color:#000;font-weight:bold">(){</span>
        <span style="color:#000;font-weight:bold">return</span> sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">selectList</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.github.wjinlei.mapper.selectRankList&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="优先使用构造器注入而不要使用autowired字段注入">优先使用构造器注入,而不要使用@Autowired字段注入</h3>
<p>这个等价于上面的用法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#3c5d5d;font-weight:bold">@Service</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">RankDao</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">final</span> SqlSession sqlSession<span style="color:#000;font-weight:bold">;</span>

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">RankDao</span><span style="color:#000;font-weight:bold">(</span>SqlSession sqlSession<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">sqlSession</span> <span style="color:#000;font-weight:bold">=</span> sqlSession<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>Rank<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">selectRankList</span><span style="color:#000;font-weight:bold">(){</span>
        <span style="color:#000;font-weight:bold">return</span> sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">selectList</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.github.wjinlei.mapper.selectRankList&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>采用构造器注入可以避免污染测试,而且<code>IDEA</code>也不会警告</p>
<h2 id="为springboot添加-freemarker-模板引擎">为Springboot添加 Freemarker 模板引擎</h2>
<ul>
<li>添加依赖</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;dependency&gt;</span>
	<span style="color:#000080">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#000080">&lt;/groupId&gt;</span>
	<span style="color:#000080">&lt;artifactId&gt;</span>spring-boot-starter-freemarker<span style="color:#000080">&lt;/artifactId&gt;</span>
<span style="color:#000080">&lt;/dependency&gt;</span>
</code></pre></div><ul>
<li>Freemarker规定,模板文件放在<code>resources/templates</code>目录中,文件名以<code>.ftlh</code>结尾</li>
</ul>
<p>添加一个模板文件<code>index.ftlh</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#000080">html</span>&gt;
&lt;<span style="color:#000080">head</span>&gt;
    &lt;<span style="color:#000080">title</span>&gt;
        排行榜
    &lt;/<span style="color:#000080">title</span>&gt;
&lt;/<span style="color:#000080">head</span>&gt;
&lt;<span style="color:#000080">body</span>&gt;
&lt;<span style="color:#000080">table</span>&gt;
    &lt;<span style="color:#000080">tr</span>&gt;
        &lt;<span style="color:#000080">th</span>&gt;排名&lt;/<span style="color:#000080">th</span>&gt;
        &lt;<span style="color:#000080">th</span>&gt;名称&lt;/<span style="color:#000080">th</span>&gt;
        &lt;<span style="color:#000080">th</span>&gt;分数&lt;/<span style="color:#000080">th</span>&gt;
    &lt;/<span style="color:#000080">tr</span>&gt;
    <span style="color:#a61717;background-color:#e3d2d2">&lt;</span>#list ranks as item&gt;
        &lt;<span style="color:#000080">tr</span>&gt;
            &lt;<span style="color:#000080">td</span>&gt;${item?index+1}&lt;/<span style="color:#000080">td</span>&gt;
            &lt;<span style="color:#000080">td</span>&gt;${item.user.name}&lt;/<span style="color:#000080">td</span>&gt;
            &lt;<span style="color:#000080">td</span>&gt;${item.score}&lt;/<span style="color:#000080">td</span>&gt;
        &lt;/<span style="color:#000080">tr</span>&gt;
    <span style="color:#a61717;background-color:#e3d2d2">&lt;</span>/#list&gt;
&lt;/<span style="color:#000080">table</span>&gt;
&lt;/<span style="color:#000080">body</span>&gt;
</code></pre></div><ul>
<li>Controller中使用<code>ModelAndView</code>将数据渲染到模板中</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#3c5d5d;font-weight:bold">@GetMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/rank&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#3c5d5d;font-weight:bold">@ResponseBody</span>
<span style="color:#000;font-weight:bold">public</span> ModelAndView <span style="color:#900;font-weight:bold">rank</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
    HashMap<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> hashMap <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HashMap<span style="color:#000;font-weight:bold">&lt;&gt;();</span>
    List<span style="color:#000;font-weight:bold">&lt;</span>Rank<span style="color:#000;font-weight:bold">&gt;</span> rankList <span style="color:#000;font-weight:bold">=</span> rankService<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getRankList</span><span style="color:#000;font-weight:bold">();</span>
    hashMap<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;ranks&#34;</span><span style="color:#000;font-weight:bold">,</span> rankList<span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> ModelAndView<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;index&#34;</span><span style="color:#000;font-weight:bold">,</span> hashMap<span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="aop面向切面编程-aspect-oriented-programming">AOP(面向切面编程 Aspect-oriented programming)</h2>
<p>面向切面编程 Aspect-oriented programming,它相对的概念是OOP(Object-oriented programming)<br>
在进入某个切面的瞬间将它拦截下来,做我们想做的事,什么是切面?反映在方法栈中,栈帧被调用的瞬间就是一个切面<br>
AOP关注的是一个统一的切面,而不是某个具体的对象或方法,说白了,AOP思想就像一个拦截器一样,<br>
对某个统一的状态拦截下来,做统一处理</p>
<ul>
<li>AOP的适用场景 需要做统一处理的地方
<ul>
<li>日志</li>
<li>缓存</li>
<li>鉴权</li>
</ul>
</li>
</ul>
<p>如果用OOP的思想应该怎么做? 答使用装饰器模式</p>
<h2 id="装饰器模式">装饰器模式</h2>
<p>在不改变原来业务逻辑的情况下,在外部在包一层,添加我们自己的功能,然后再调用原来的功能<br>
装饰器模式,一般配合接口使用,例如有如下示例:</p>
<ul>
<li>Hello 接口</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">Hello</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">hello</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>HelloWorld 实现类</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HelloWorld</span> <span style="color:#000;font-weight:bold">implements</span> Hello <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">hello</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello World!&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>Main</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        Hello hello <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HelloWorld<span style="color:#000;font-weight:bold">();</span>
        hello<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hello</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>现在,想要给HelloWorld的<code>hello</code>方法添加一个功能,输出&quot;Hello Maven&quot;,在不改变代码的情况洗下我们应该怎么做?</p>
<ul>
<li>新建一个<code>HelloMavenDecorator</code>实现类,内部包裹一个<code>HelloWorld</code>成员</li>
</ul>
<p>一般约定,装饰器类,名称后面添加<code>Decorator</code>后缀,表示这是一个装饰器类,</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HelloMavenDecorator</span> <span style="color:#000;font-weight:bold">implements</span> Hello <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">private</span> HelloWorld helloWorld<span style="color:#000;font-weight:bold">;</span>

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">HelloMavenDecorator</span><span style="color:#000;font-weight:bold">(</span>HelloWorld helloWorld<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">helloWorld</span> <span style="color:#000;font-weight:bold">=</span> helloWorld<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">hello</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello Maven&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 我们的新功能
</span><span style="color:#998;font-style:italic"></span>        helloWorld<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hello</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#998;font-style:italic">// 调用原来的功能
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>Main 这时候调用就变成了如下的样子</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        Hello hello <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HelloMavenDecorator<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> HelloWorld<span style="color:#000;font-weight:bold">());</span>
        hello<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hello</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>这就是装饰器模式</p>
<h2 id="aop的两种实现jdk动态代理和字节码生成">AOP的两种实现,JDK动态代理和字节码生成</h2>
<h3 id="jdk动态代理">JDK动态代理</h3>
<p>下面我们通过JDK的动态代理功能,实现和上面装饰器模式同样的功能</p>
<ul>
<li>创建一个代理类,今后所有被拦截的方法,都会进入这个类的<code>invoke</code>方法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HelloProxy</span> <span style="color:#000;font-weight:bold">implements</span> InvocationHandler <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">private</span> Hello delegate<span style="color:#000;font-weight:bold">;</span> <span style="color:#998;font-style:italic">// 被代理对象
</span><span style="color:#998;font-style:italic"></span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">HelloProxy</span><span style="color:#000;font-weight:bold">(</span>Hello delegate<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">delegate</span> <span style="color:#000;font-weight:bold">=</span> delegate<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> Object <span style="color:#900;font-weight:bold">invoke</span><span style="color:#000;font-weight:bold">(</span>Object proxy<span style="color:#000;font-weight:bold">,</span> Method method<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello Proxy&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 我们的功能
</span><span style="color:#998;font-style:italic"></span>        method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">invoke</span><span style="color:#000;font-weight:bold">(</span>delegate<span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 原来的功能
</span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>Main</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        HelloWorld helloWorld <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HelloWorld<span style="color:#000;font-weight:bold">();</span>
        Hello hello <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>Hello<span style="color:#000;font-weight:bold">)</span> Proxy<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">newProxyInstance</span><span style="color:#000;font-weight:bold">(</span>
                helloWorld<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getClass</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">getClassLoader</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#998;font-style:italic">// 被代理对象的ClassLoader
</span><span style="color:#998;font-style:italic"></span>                <span style="color:#000;font-weight:bold">new</span> Class<span style="color:#000;font-weight:bold">[]{</span>Hello<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#998;font-style:italic">// 要代理的接口,只有被代理的接口未来被调用的时候才会被拦截
</span><span style="color:#998;font-style:italic"></span>                <span style="color:#000;font-weight:bold">new</span> HelloProxy<span style="color:#000;font-weight:bold">(</span>helloWorld<span style="color:#000;font-weight:bold">));</span> <span style="color:#998;font-style:italic">// 代理对象实例,说白了当拦截发生时交给谁去处理
</span><span style="color:#998;font-style:italic"></span>        hello<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hello</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>到现在为止,你可以看不出AOP的好处,那么请看下面的示例</p>
<ul>
<li>Hello 接口 现在我们的Hello接口有2个方法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">Hello</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">hello</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">uuid</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>HelloWorld实现类 覆盖这两个方法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HelloWorld</span> <span style="color:#000;font-weight:bold">implements</span> Hello <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">uuid</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>UUID<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">randomUUID</span><span style="color:#000;font-weight:bold">());</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">hello</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello World!&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>HelloMavenDelegate 装饰器类</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HelloMavenDecorator</span> <span style="color:#000;font-weight:bold">implements</span> Hello <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">private</span> HelloWorld helloWorld<span style="color:#000;font-weight:bold">;</span>

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">HelloMavenDecorator</span><span style="color:#000;font-weight:bold">(</span>HelloWorld helloWorld<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">helloWorld</span> <span style="color:#000;font-weight:bold">=</span> helloWorld<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">hello</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello Maven&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 这里实现了一次
</span><span style="color:#998;font-style:italic"></span>        helloWorld<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hello</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">uuid</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello Maven&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 这里实现了一次
</span><span style="color:#998;font-style:italic"></span>        helloWorld<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">uuid</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>从上面就可以看出,装饰器模式同样的逻辑实现了两次,很麻烦,如果有100个方法呢?</p>
<p>接下来看看动态代理怎么处理</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        HelloWorld helloWorld <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HelloWorld<span style="color:#000;font-weight:bold">();</span>
        Hello hello <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>Hello<span style="color:#000;font-weight:bold">)</span> Proxy<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">newProxyInstance</span><span style="color:#000;font-weight:bold">(</span>
                helloWorld<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getClass</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">getClassLoader</span><span style="color:#000;font-weight:bold">(),</span>
                <span style="color:#000;font-weight:bold">new</span> Class<span style="color:#000;font-weight:bold">[]{</span>Hello<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">new</span> HelloProxy<span style="color:#000;font-weight:bold">(</span>helloWorld<span style="color:#000;font-weight:bold">));</span>
        hello<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hello</span><span style="color:#000;font-weight:bold">();</span>
        hello<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">uuid</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#998;font-style:italic">// 动态代理什么都不需要做? 你直接调用新方法就可以了,它直接就实现了同样的逻辑
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>JDK动态代理的限制,只能代理接口,如果我们想代理一个普通的类,而不是接口,就不能用JDK的动态代理了</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Object <span style="color:#900;font-weight:bold">newProxyInstance</span><span style="color:#000;font-weight:bold">(</span>ClassLoader loader<span style="color:#000;font-weight:bold">,</span> <span style="color:#998;font-style:italic">// 被代理对象的ClassLoader
</span><span style="color:#998;font-style:italic"></span>                                          Class<span style="color:#000;font-weight:bold">&lt;?&gt;[]</span> interfaces<span style="color:#000;font-weight:bold">,</span> <span style="color:#998;font-style:italic">// 要代理的接口
</span><span style="color:#998;font-style:italic"></span>                                          InvocationHandler h<span style="color:#000;font-weight:bold">)</span> <span style="color:#998;font-style:italic">// 交给谁处理
</span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">throws</span> IllegalArgumentException
<span style="color:#000;font-weight:bold">{</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="cglibbytebuddy">CGLIB/ByteBuddy</h3>
<p>要想代理普通类,我们可以通过<code>CGLIB</code>或者<code>ByteBuddy</code>,<code>ByteBuddy</code>之前在<a href="/posts/exp-java-day24/#%E6%B3%A8%E8%A7%A3%E5%AE%9E%E6%88%98%E5%AE%9E%E7%8E%B0%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%9A%84%E7%BC%93%E5%AD%98%E8%A3%85%E9%A5%B0%E5%99%A8">注解章节</a> 已经演示过了,这里就不再演示了</p>
<ul>
<li>下面我们演示下,使用CGLIB来代理普通类</li>
</ul>
<p>我们把HelloWorld改成普通类</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HelloWorld</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">uuid</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>UUID<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">randomUUID</span><span style="color:#000;font-weight:bold">());</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">hello</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello World!&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>引入CGLIB</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#998;font-style:italic">&lt;!-- https://mvnrepository.com/artifact/cglib/cglib --&gt;</span>
<span style="color:#000080">&lt;dependency&gt;</span>
    <span style="color:#000080">&lt;groupId&gt;</span>cglib<span style="color:#000080">&lt;/groupId&gt;</span>
    <span style="color:#000080">&lt;artifactId&gt;</span>cglib<span style="color:#000080">&lt;/artifactId&gt;</span>
    <span style="color:#000080">&lt;version&gt;</span>3.3.0<span style="color:#000080">&lt;/version&gt;</span>
<span style="color:#000080">&lt;/dependency&gt;</span>
</code></pre></div><ul>
<li>创建代理类</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HelloWorldProxy</span> <span style="color:#000;font-weight:bold">implements</span> MethodInterceptor <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">private</span> HelloWorld delegate<span style="color:#000;font-weight:bold">;</span>

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">HelloWorldProxy</span><span style="color:#000;font-weight:bold">(</span>HelloWorld delegate<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">delegate</span> <span style="color:#000;font-weight:bold">=</span> delegate<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> Object <span style="color:#900;font-weight:bold">intercept</span><span style="color:#000;font-weight:bold">(</span>Object o<span style="color:#000;font-weight:bold">,</span> Method method<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">[]</span> objects<span style="color:#000;font-weight:bold">,</span> MethodProxy methodProxy<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Hello Proxy&#34;</span><span style="color:#000;font-weight:bold">);</span>
        method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">invoke</span><span style="color:#000;font-weight:bold">(</span>delegate<span style="color:#000;font-weight:bold">,</span> objects<span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>代理对象</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        HelloWorld helloWorld <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HelloWorld<span style="color:#000;font-weight:bold">();</span>
        Enhancer enhancer <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> Enhancer<span style="color:#000;font-weight:bold">();</span> <span style="color:#998;font-style:italic">// 创建Enhancer对象
</span><span style="color:#998;font-style:italic"></span>        enhancer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setSuperclass</span><span style="color:#000;font-weight:bold">(</span>HelloWorld<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 设置父类,因为它实际是动态生成一个子类对象来进行扩展,和ByteBuudy一样
</span><span style="color:#998;font-style:italic"></span>        enhancer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCallback</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> HelloWorldProxy<span style="color:#000;font-weight:bold">(</span>helloWorld<span style="color:#000;font-weight:bold">));</span> <span style="color:#998;font-style:italic">// 设置代理对象,当拦截发生时给谁处理
</span><span style="color:#998;font-style:italic"></span>        HelloWorld proxy <span style="color:#000;font-weight:bold">=(</span>HelloWorld<span style="color:#000;font-weight:bold">)</span> enhancer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">create</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#998;font-style:italic">// 创建代理对象
</span><span style="color:#998;font-style:italic"></span>        proxy<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hello</span><span style="color:#000;font-weight:bold">();</span>
        proxy<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">uuid</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>可以看到和JDK动态代理几乎一样,只不过好处是可以代理普通类,但不能代理final和final/private类,因为继承的原因嘛</p>
<h2 id="在springboot中使用aop">在Springboot中使用AOP</h2>
<ul>
<li>添加依赖</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#998;font-style:italic">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-aop --&gt;</span>
<span style="color:#000080">&lt;dependency&gt;</span>
    <span style="color:#000080">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#000080">&lt;/groupId&gt;</span>
    <span style="color:#000080">&lt;artifactId&gt;</span>spring-boot-starter-aop<span style="color:#000080">&lt;/artifactId&gt;</span>
    <span style="color:#000080">&lt;version&gt;</span>2.6.0<span style="color:#000080">&lt;/version&gt;</span>
<span style="color:#000080">&lt;/dependency&gt;</span>
</code></pre></div><ul>
<li>配置AOP模式(是使用JDK动态代理还是CGLIB)</li>
</ul>
<pre tabindex="0"><code class="language-properties" data-lang="properties"># 表示使用CGLIB
spring.aop.proxy-target-class=true
</code></pre><ul>
<li>新建Aspect(切面)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#3c5d5d;font-weight:bold">@Aspect</span> <span style="color:#998;font-style:italic">// @Aspect注解声明这是一个切面类(代理类)
</span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@Configuration</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CacheAspect</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#3c5d5d;font-weight:bold">@Around</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;@annotation(annotation.Cache)&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#998;font-style:italic">// 所有标注了@Cache注解的都会被拦截
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">public</span> Object <span style="color:#900;font-weight:bold">cache</span><span style="color:#000;font-weight:bold">(</span>ProceedingJoinPoint proceedingJoinPoint<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;cache is run...&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">return</span> proceedingJoinPoint<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">proceed</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#998;font-style:italic">// 让这个方法继续运行,处理它该做的事情
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="关于切面的拦截方式">关于切面的拦截方式</h3>
<ul>
<li>@Before 在切入点开始处切入内容</li>
<li>@After 在切入点结尾处切入内容</li>
<li>@Around 自己控制何时执行切入点切入内容</li>
</ul>
<h2 id="redis">Redis</h2>
<p>Redis是内存型数据库</p>
<ul>
<li>docker安装redis</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo docker run --name redis -p 6379:6379 -d redis:6.2.6
</code></pre></div><h3 id="在springboot中使用redis">在Springboot中使用Redis</h3>
<ul>
<li>添加依赖</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#998;font-style:italic">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-redis --&gt;</span>
<span style="color:#000080">&lt;dependency&gt;</span>
    <span style="color:#000080">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#000080">&lt;/groupId&gt;</span>
    <span style="color:#000080">&lt;artifactId&gt;</span>spring-boot-starter-data-redis<span style="color:#000080">&lt;/artifactId&gt;</span>
    <span style="color:#000080">&lt;version&gt;</span>2.6.0<span style="color:#000080">&lt;/version&gt;</span>
<span style="color:#000080">&lt;/dependency&gt;</span>
</code></pre></div><ul>
<li>配置Springboot</li>
</ul>
<pre tabindex="0"><code class="language-properties" data-lang="properties">spring.redis.host=localhost
spring.redis.port=6379
</code></pre><ul>
<li>创建Redis配置类,说白了就是一个Bean,它返回一个Redis模板,用于方便操作Redis</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#3c5d5d;font-weight:bold">@Configuration</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">RedisConfig</span> <span style="color:#000;font-weight:bold">{</span>
    RedisTemplate<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">redisTemplate</span><span style="color:#000;font-weight:bold">(</span>RedisConnectionFactory redisConnectionFactory<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        RedisTemplate<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> redisTemplate <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> RedisTemplate<span style="color:#000;font-weight:bold">&lt;&gt;();</span>
        redisTemplate<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setConnectionFactory</span><span style="color:#000;font-weight:bold">(</span>redisConnectionFactory<span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">return</span> redisTemplate<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ul>
<li>将redisTremplate注入后,就可以使用了,下面是一个缓存例子</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#3c5d5d;font-weight:bold">@Aspect</span>
<span style="color:#3c5d5d;font-weight:bold">@Configuration</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CacheAspect</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">final</span> RedisTemplate<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> redisTemplate<span style="color:#000;font-weight:bold">;</span>

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">CacheAspect</span><span style="color:#000;font-weight:bold">(</span>RedisTemplate<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> redisTemplate<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">redisTemplate</span> <span style="color:#000;font-weight:bold">=</span> redisTemplate<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#3c5d5d;font-weight:bold">@Around</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;@annotation(annotation.Cache)&#34;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">public</span> Object <span style="color:#900;font-weight:bold">cache</span><span style="color:#000;font-weight:bold">(</span>ProceedingJoinPoint proceedingJoinPoint<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
        MethodSignature methodSignature <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>MethodSignature<span style="color:#000;font-weight:bold">)</span> proceedingJoinPoint<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSignature</span><span style="color:#000;font-weight:bold">();</span>
        String methodSignatureName <span style="color:#000;font-weight:bold">=</span> methodSignature<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">();</span>
        Object cacheV <span style="color:#000;font-weight:bold">=</span> redisTemplate<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">opsForValue</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>methodSignatureName<span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>cacheV <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;return value from redis...&#34;</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#000;font-weight:bold">return</span> cacheV<span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span>
        Object value <span style="color:#000;font-weight:bold">=</span> proceedingJoinPoint<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">proceed</span><span style="color:#000;font-weight:bold">();</span>
        redisTemplate<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">opsForValue</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">set</span><span style="color:#000;font-weight:bold">(</span>methodSignatureName<span style="color:#000;font-weight:bold">,</span> value<span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">return</span> value<span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div>
    </div>
  </article>

  
  




  <div class="blog-post-comments">
    
      <div id="disquss_thread">
  <script src="https://utteranc.es/client.js"
    repo="Wjinlei/wjinlei.github.io"
    issue-term="pathname"
    label="Wjinlei"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>
</div>

    
  </div>



  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Writings</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&text=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&title=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&is_video=false&description=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29&body=Check out this article: https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&title=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&title=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&name=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29&description=WEB%e5%90%8e%e7%ab%af%e5%bc%80%e5%8f%91%e4%b8%ad%e7%9a%84%e4%b8%89%e5%b1%82%e7%bb%93%e6%9e%84%20%20Controller%20%e5%8f%aa%e5%81%9a%e5%92%8cHTTP%e8%af%b7%e6%b1%82%e5%93%8d%e5%ba%94%e7%9b%b8%e5%85%b3%e7%9a%84%e4%ba%8b%e6%83%85%20Service%20%e5%81%9a%e7%9a%84%e4%ba%8b%e6%83%85%e6%9c%80%e5%a4%9a%2c%e5%a4%84%e7%90%86%e4%b8%9a%e5%8a%a1%e9%80%bb%e8%be%91%20DAO%20%e5%8f%aa%e5%81%9a%e6%95%b0%e6%8d%ae%e5%ba%93%e6%93%8d%e4%bd%9c%e7%9b%b8%e5%85%b3%e7%9a%84%e4%ba%8b%e6%83%85%20%20%e4%b8%baSpringboot%e6%b7%bb%e5%8a%a0MyBatis%e6%a8%a1%e5%9d%97%20Springboot%e4%b8%ba%e6%88%91%e4%bb%ac%e5%87%86%e5%a4%87%e4%ba%86%e5%be%88%e5%a4%9a%e4%b8%ba%e5%88%9d%e5%ad%a6%e8%80%85%e5%87%86%e5%a4%87%e7%9a%84%e6%a8%a1%e5%9d%97%2c%e7%a7%b0%e4%b8%bastarter%0a%20%e6%b7%bb%e5%8a%a0MyBatis%e6%a8%a1%e5%9d%97%20%20%26lt%3bdependency%26gt%3b%20%26lt%3bgroupId%26gt%3borg.mybatis.spring.boot%26lt%3b%2fgroupId%26gt%3b%20%26lt%3bartifactId%26gt%3bmybatis-spring-boot-starter%26lt%3b%2fartifactId%26gt%3b%20%26lt%3bversion%26gt%3b2.2.0%26lt%3b%2fversion%26gt%3b%20%26lt%3b%2fdependency%26gt%3b%20%20%e9%85%8d%e7%bd%aeSpringboot%e6%95%b0%e6%8d%ae%e6%ba%90%20%20spring.datasource.url%3djdbc%3ah2%3afile%3a.%2ftarget%2ftest%20spring.datasource.username%3droot%20spring.datasource.password%3droot%20spring.datasource.driver-class-name%3dorg.h2.Driver%20mybatis.config-location%3dclasspath%3adb%2fmybatis%2fmybatis-config.xml%20%20%e9%85%8d%e7%bd%aeMyBatis%20%20%26lt%3b%3fxml%20version%3d%26%2334%3b1.0%26%2334%3b%20encoding%3d%26%2334%3bUTF-8%26%2334%3b%20%3f%26gt%3b%20%26lt%3b%21DOCTYPE%20configuration%20PUBLIC%20%26%2334%3b-%2f%2fmybatis.org%2f%2fDTD%20Config%203.0%2f%2fEN%26%2334%3b%20%26%2334%3bhttp%3a%2f%2fmybatis.org%2fdtd%2fmybatis-3-config.dtd%26%2334%3b%26gt%3b%20%26lt%3bconfiguration%26gt%3b%20%26lt%3b%21--%20%e5%9b%a0%e4%b8%bamybatis%e7%9a%84%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae%e5%b7%b2%e7%bb%8f%e5%9c%a8Spring%e4%b8%ad%e9%85%8d%e7%bd%ae%e4%ba%86%2c%e5%9b%a0%e6%ad%a4%e8%bf%99%e9%87%8c%e5%8f%aa%e9%9c%80%e8%a6%81Mapper%e9%85%8d%e7%bd%ae%e5%8d%b3%e5%8f%af%20--%26gt%3b%20%26lt%3bmappers%26gt%3b%20%26lt%3bmapper%20resource%3d%26%2334%3bdb%2fmybatis%2fmybatis-mapper.xml%26%2334%3b%2f%26gt%3b%20%26lt%3b%2fmappers%26gt%3b%20%26lt%3b%2fconfiguration%26gt%3b%20%e5%85%b6%e4%bb%96%e7%9a%84%e6%93%8d%e4%bd%9c%e5%b0%b1%e5%92%8c%e6%ad%a3%e5%b8%b8%e4%bd%bf%e7%94%a8MyBatis%e4%b8%80%e6%a0%b7%e4%ba%86%0a%e5%85%b3%e4%ba%8eBean%20%e4%b9%8b%e5%89%8d%e6%88%91%e4%bb%ac%e4%ba%86%e8%a7%a3%e5%88%b0%2c%e5%9c%a8MyBatis%e4%b8%ad%e9%85%8d%e7%bd%aeSQL%e5%8f%af%e4%bb%a5%e7%94%a8%e6%8e%a5%e5%8f%a3%e7%9a%84%e6%96%b9%e5%bc%8f%2c%e5%8f%aa%e8%a6%81%e5%a3%b0%e6%98%8e%e4%b8%80%e4%b8%aa%e6%8e%a5%e5%8f%a3%2c%e8%8e%b7%e5%8f%96%e4%b8%80%e4%b8%aaMapper%e5%af%b9%e8%b1%a1%2c%e5%b0%b1%e5%8f%af%e4%bb%a5%e7%9b%b4%e6%8e%a5%e6%89%a7%e8%a1%8cSQL%e4%ba%86%0a%2f%2a%2a%20%2a%20%e5%88%a0%e9%99%a4%e4%b8%80%e4%b8%aa%e7%94%a8%e6%88%b7%e3%80%82%20%2a%20%2a%20%40param%20id%20%e5%be%85%e5%88%a0%e9%99%a4%e7%9a%84%e7%94%a8%e6%88%b7ID%20%2a%2f%20public%20void%20deleteUserById%28Integer%20id%29%20%7b%20try%20%28SqlSession%20sqlSession%20%3d%20sqlSessionFactory." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwjinlei.github.io%2fposts%2fexp-java-day27%2f&t=Java%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0%28%e7%ac%ac%e4%ba%8c%e5%8d%81%e4%b8%83%e5%a4%a9%29" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  this 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
